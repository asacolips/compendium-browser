{"version":3,"file":"components.vue.es.js","sources":["../vue/methods/Helpers.js","../vue/components/parts/Tabs.vue","../vue/components/parts/Tab.vue","../vue/components/dialogs/compendium-browser/stub.vue","../vue/CompendiumBrowser.vue"],"sourcesContent":["export function getSafeValue(property, defaultValue) {\n  if (property) return property.value;\n  return defaultValue;\n}\n\nexport function localize(key) {\n  return game.i18n.localize(key);\n}\n\nexport function cssClass(string) {\n  return encodeURIComponent(\n    string.trim().toLowerCase()\n  ).replace(/%[0-9A-F]{2}/gi, '-');\n}\n\nexport function numberFormat(value, dec = 0, sign = false) {\n  value = parseFloat(value).toFixed(dec);\n  if (sign ) return ( value >= 0 ) ? `+${value}` : value;\n  return value;\n}\n\nexport function concat(...args) {\n  return args.reduce((acc, cur) => {\n    return acc + cur;\n  }, '');\n}\n\nexport async function getActor(actorData) {\n  // If no drag data is available, we can't retrieve the actor.\n  if (!actorData?.dragData?.uuid) return false;\n\n  // Async load the actor/token from the UUID.\n  const document = await fromUuid(actorData.dragData.uuid);\n\n  // If it's a token, retrieve the actor prop. Otherwise, retrieve the document.\n  return document?.actor ?? document;\n}\n\n/**\n * Retrieve module art for an actor\n *\n * @param {object} actor Index version of an actor document from a compendium.\n * @returns {string} Path to art asset\n */\nexport function getActorModuleArt(actor) {\n  // UUID doesn't exactly match the format used in the map currently.\n  const actorMapId = actor.uuid.replace('.Actor', '');\n  // Retrieve the art from the map, or fallback to the actor image.\n  const art = game.archmage.system.moduleArt.map.get(actorMapId);\n  return art?.actor ?? actor.img;\n}\n\n/**\n * Retrieve index for a list of compendiums.\n *\n * @param {Array} packNames Array of compendiums to index.\n * @param {Array} fields Array of field paths to include in the index.\n * @returns Combined entries from the queried compendiums.\n */\nexport async function getPackIndex(packNames = [], fields = []) {\n  if (!packNames) return;\n  if (!fields || fields.length < 1) return;\n\n  let packs = [];\n\n  for (let packName of packNames) {\n    const pack = game.packs.get(packName);\n    const packIndex = await pack.getIndex({fields: fields});\n    packs = packs.concat(packIndex.contents);\n  }\n\n  return packs;\n}\n\n/**\n * Open a document's sheet based on its uuid.\n *\n * @param {string} uuid Document UUID to open.\n * @param {string} type Document type to open. Defaults to 'Actor'.\n */\nexport function openDocument(uuid, type = 'Actor') {\n  getDocumentClass(type).fromDropData({\n    type: type,\n    uuid: uuid\n  }).then(document => {\n    if (document?.sheet) {\n      document.sheet.render(true);\n    }\n    else {\n      console.warn(`No document found for ${uuid}`);\n    }\n  });\n}\n\n/**\n * Starts a drag event and provides document drop data.\n *\n * @param {Event} event Drag event.\n * @param {Object} entry Pack index entry object.\n */\nexport function startDrag(event, entry, type = 'Actor') {\n  event.dataTransfer.setData('text/plain', JSON.stringify({\n    type: type,\n    uuid: entry.uuid\n  }));\n}\n","<template>\n  <section class=\"section section--tabs flexshrink\">\n    <nav :class=\"'sheet-tabs tabs tabs--' + group\" :data-group=\"group\">\n      <span v-for=\"(tab, tabKey) in tabs\" :key=\"'tab-' + group + '-' + tabKey\">\n        <a @click=\"changeTab\" :class=\"getTabClass(tab, tabKey)\" :data-tab=\"tabKey\" v-if=\"!tab.hidden\">\n          <i v-if=\"tab.icon\" :class=\"concat('fas ', tab.icon)\"></i>\n          <span v-if=\"!tab.hideLabel\">{{tab.label}}</span>\n        </a>\n      </span>\n    </nav>\n  </section>\n</template>\n\n<script>\nimport { concat, getActor } from '@/methods/Helpers';\nexport default {\n  name: 'Tabs',\n  props: ['context', 'actor', 'group', 'tabs', 'flags'],\n  setup() {\n    return { concat }\n  },\n  data() {\n    return {\n      currentTab: 'creatures'\n    }\n  },\n  methods: {\n    changeTab(event) {\n      // If this was a click, update the default tab.\n      if (event && event.currentTarget) {\n        this.currentTab = event.currentTarget.dataset.tab;\n      }\n\n      // Update the tab displays.\n      for (let [k,v] of Object.entries(this.tabs)) {\n        this.tabs[k].active = false;\n      }\n\n      // Update the active tab display.\n      if (this.tabs[this.currentTab]) {\n        this.tabs[this.currentTab].active = true;\n      }\n    },\n    getTabClass(tab, index) {\n      return `tab-link tab-link--${index}${tab.active ? ' active': ''}`;\n    }\n  },\n  async mounted() {\n    const activeTab = Object.values(this.tabs)?.find((tab) => tab.active);\n    Object.values(this.tabs).forEach((tab) => console.log(tab));\n    console.log('Active', activeTab);\n    this.currentTab = activeTab?.key ?? 'creatures';\n    this.changeTab(false);\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n</style>","<template>\n  <div :class=\"'tab ' + tab.key + (tab.active ? ' active' : '') + (classes ? ' ' + classes : '')\" :data-group=\"group\" :data-tab=\"tab.key\">\n    <slot></slot>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: 'Tab',\n    props: ['context', 'actor', 'tab', 'group', 'classes']\n  }\n</script>\n\n<style lang=\"scss\">\n\n</style>","<template>\n  <h1><slot></slot></h1>\n</template>\n\n<script>\n  export default {\n    name: 'Stub',\n    props: ['context']\n  }\n</script>\n\n<style lang=\"less\" scoped>\n  h1 {\n    color: red;\n  }\n</style>","<template>\n  <div class=\"compendium-browser-vue flexcol\">\n    <!-- Tabs. -->\n    <section class=\"container container--top\">\n      <Tabs group=\"primary\" :tabs=\"tabs.primary\"/>\n    </section>\n\n    <!-- Filters + Content. -->\n    <section class=\"container container--bottom\">\n\n      <!--\n        Render each tab wrapper and their contents. The CompendiumBrowser<Type> components\n        each have a v-if on them that causes them to only render if they're active or if they\n        have been opened at least once.\n      -->\n      <Tab group=\"primary\" :tab=\"tabs.primary.creatures\" classes=\"container container--bottom flexrow\">\n        <Stub>Creatures</Stub>\n        <!-- <CompendiumBrowserCreatures v-if=\"tabs.primary.creatures.active || tabs.primary.creatures.opened\" :tab=\"tabs.primary.creatures\"/> -->\n      </Tab>\n\n      <Tab group=\"primary\" :tab=\"tabs.primary.powers\" classes=\"container container--bottom flexrow\">\n        <Stub>Spells</Stub>\n        <!-- <CompendiumBrowserPowers v-if=\"tabs.primary.powers.active || tabs.primary.powers.opened\" :tab=\"tabs.primary.powers\" :escalation=\"this.context.escalationDie\"/> -->\n      </Tab>\n\n      <Tab group=\"primary\" :tab=\"tabs.primary.items\" classes=\"container container--bottom flexrow\">\n        <Stub>Items</Stub>\n        <!-- <CompendiumBrowserItems v-if=\"tabs.primary.items.active || tabs.primary.items.opened\" :tab=\"tabs.primary.items\"/> -->\n      </Tab>\n\n    </section>\n  </div>\n</template>\n\n<script>\n// Import component dependencies.\nimport Tabs from '@/components/parts/Tabs.vue';\nimport Tab from '@/components/parts/Tab.vue';\nimport Stub from '@/components/dialogs/compendium-browser/stub.vue';\n// import CompendiumBrowserCreatures from '@/components/dialogs/compendium-browser/CompendiumBrowserCreatures.vue';\n// import CompendiumBrowserPowers from '@/components/dialogs/compendium-browser/CompendiumBrowserPowers.vue';\n// import CompendiumBrowserItems from '@/components/dialogs/compendium-browser/CompendiumBrowserItems.vue';\n\nexport default {\n  name: 'ArchmageCompendiumBrowser',\n  props: [`context`],\n  components: {\n    Tabs,\n    Tab,\n    Stub,\n    // CompendiumBrowserCreatures,\n    // CompendiumBrowserPowers,\n    // CompendiumBrowserItems\n  },\n  setup() {\n    return {\n      CONFIG,\n      game\n    }\n  },\n  data() {\n    return {\n      // The only variable we actually need to track is the active tab.\n      tabs: {\n        primary: {\n          // Default tab is assigned in the flags() computed property.\n          creatures: {\n            key: 'creatures',\n            label: game.i18n.localize('CMPBrowser.Tab.NPCBrowser'),\n            active: this.context?.defaultTab === 'creatures' ?? false,\n            opened: false\n          },\n          powers: {\n            key: 'powers',\n            label: game.i18n.localize('CMPBrowser.Tab.SpellBrowser'),\n            active: this.context?.defaultTab === 'powers' ?? false,\n            opened: false\n          },\n          items: {\n            key: 'items',\n            label: game.i18n.localize('CMPBrowser.Tab.ItemBrowser'),\n            active: this.context?.defaultTab === 'items' ?? false,\n            opened: false\n          }\n        }\n      }\n    }\n  },\n  methods: {},\n  computed: {},\n  watch: {},\n  async created() {\n    console.log(\"Creating compendium browser...\");\n  },\n  async mounted() {\n    // const defaultTab = this?.context?.defaultTab ?? 'creatures';\n    // if (this.tabs.primary?.[defaultTab]) {\n    //   this.tabs.primary[defaultTab].active = true;\n    // }\n    // else {\n    //   this.tabs.primary.creatures.active = true;\n    // }\n    console.log(\"Compendium browser mounted.\");\n  }\n}\n</script>"],"names":["concat","args","acc","cur","_sfc_main","event","k","v","tab","index","activeTab","_a","_hoisted_1","_hoisted_2","_hoisted_3","_openBlock","_createElementBlock","_createElementVNode","_normalizeClass","$props","_Fragment","_renderList","tabKey","_createCommentVNode","$options","$setup","_hoisted_4","_toDisplayString","_renderSlot","_ctx","Tabs","Tab","Stub","_b","_c","_createVNode","_component_Tabs","$data","_component_Tab","_withCtx","_component_Stub","_createTextVNode"],"mappings":"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"}